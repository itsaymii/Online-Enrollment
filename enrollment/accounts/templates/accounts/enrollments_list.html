<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Enrollments List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
        <script src="/static/modal.js"></script>
    <style>
    .modal {
        display: none;
        position: fixed;
        z-index: 9999;
        left: 0;
        top: 0;
        width: 100vw;
        height: 100vh;
        overflow: auto;
        background: rgba(0,0,0,0.2);
    }
    .modal.show {
        display: flex !important;
        align-items: center;
        justify-content: center;
    }
    .modal-content {
        background: linear-gradient(135deg, #f8fafc 60%, #e3e6ed 100%);
        border-radius: 20px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.18);
        padding: 40px 32px 32px 32px;
        max-width: 420px;
        margin: 0;
        z-index: 10000;
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        border: 1px solid #e3e6ed;
        transition: box-shadow 0.2s, transform 0.2s;
        animation: modalPop 0.3s cubic-bezier(.25,.8,.25,1);
    }
    @keyframes modalPop {
        0% { transform: scale(0.95) translateY(20px); opacity: 0; }
        100% { transform: scale(1) translateY(0); opacity: 1; }
    }
    .modal-content h2 {
        font-size: 1.6rem;
        font-weight: 700;
        color: #2563eb;
        margin-bottom: 18px;
        letter-spacing: 0.5px;
        text-align: center;
    }
    .modal-content form {
        width: 100%;
    }
    .modal-content .close {
        position: absolute;
        top: 18px;
        right: 18px;
        font-size: 1.3rem;
        background: #e3e6ed;
        color: #2563eb;
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        transition: background 0.2s, color 0.2s;
    }
    .modal-content .close:hover {
        background: #2563eb;
        color: #fff;
    }
    .modal-content button[type="submit"] {
        width: 100%;
        font-size: 1.1rem;
        padding: 12px 0;
        border-radius: 8px;
        font-weight: 600;
        box-shadow: 0 2px 8px rgba(0,0,0,0.07);
        margin-top: 10px;
        transition: background 0.2s, color 0.2s;
    }
    .modal-content .btn-success {
        background: linear-gradient(90deg, #22c55e 60%, #16a34a 100%);
        border: none;
    }
    .modal-content .btn-success:hover {
        background: linear-gradient(90deg, #16a34a 60%, #22c55e 100%);
        color: #fff;
    }
    .modal-content .btn-primary {
        background: linear-gradient(90deg, #2563eb 60%, #0d6efd 100%);
        border: none;
    }
    .modal-content .btn-primary:hover {
        background: linear-gradient(90deg, #0d6efd 60%, #2563eb 100%);
        color: #fff;
    }
    .modal-content input, .modal-content select {
        border-radius: 8px;
        border: 1px solid #e3e6ed;
        padding: 10px;
        margin-bottom: 10px;
        font-size: 1rem;
        width: 100%;
        box-sizing: border-box;
        background: #f8fafc;
        transition: border 0.2s;
    }
    .modal-content input:focus, .modal-content select:focus {
        border: 1.5px solid #2563eb;
        outline: none;
        background: #fff;
    }
    .modal-blur .main-content {
        filter: blur(4px);
        pointer-events: none;
        user-select: none;
    }
    .modal {
        filter: none !important;
    }
    </style>
    <script src="/static/modal.js"></script>

<script>
function openModal(id) {
    document.getElementById(id).classList.add('show');
    document.body.classList.add('modal-blur');
}
function closeModal(id) {
    document.getElementById(id).classList.remove('show');
    document.body.classList.remove('modal-blur');
}
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.modal .close').forEach(function(btn) {
        btn.onclick = function() {
            closeModal(btn.closest('.modal').id);
        };
    });
});
</script>
</head>
<body>
    {% if messages %}
    <div class="container mt-3">
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    </div>
    {% endif %}
    <div class="container mt-3 main-content" style="background: #f9f9f9; border-radius: 18px; box-shadow: 0 2px 12px rgba(0,0,0,0.04); padding: 32px 24px;">
        <div class="d-flex align-items-center justify-content-between mb-4">
            <h2 class="fw-bold text-primary mb-0">Enrollments List</h2>
            <button class="btn btn-success rounded-3 fw-semibold px-4 py-2" onclick="openModal('addEnrollmentModal')">Add Enrollment</button>
        </div>
        <div class="table-responsive" style="max-height: 520px; min-height: 420px; overflow-y: auto;">
            <table class="table align-middle bg-white rounded-4 shadow-sm overflow-hidden" style="min-width: 700px;">
                    <thead class="bg-primary text-white" style="position: sticky; top: 0; z-index: 2;">
                        <tr style="border-radius: 12px;">
                            <th class="py-3 px-4" style="position: sticky; top: 0; background: linear-gradient(90deg, #2563eb 60%, #0d6efd 100%); z-index: 3;">Enrollment ID</th>
                            <th class="py-3 px-4" style="position: sticky; top: 0; background: linear-gradient(90deg, #2563eb 60%, #0d6efd 100%); z-index: 3;">Course ID</th>
                            <th class="py-3 px-4" style="position: sticky; top: 0; background: linear-gradient(90deg, #2563eb 60%, #0d6efd 100%); z-index: 3;">Student ID</th>
                            <th class="py-3 px-4" style="position: sticky; top: 0; background: linear-gradient(90deg, #2563eb 60%, #0d6efd 100%); z-index: 3;">Enrollment Date</th>
                            <th class="py-3 px-4" style="position: sticky; top: 0; background: linear-gradient(90deg, #2563eb 60%, #0d6efd 100%); z-index: 3;">Status</th>
                            <th class="py-3 px-4" style="position: sticky; top: 0; background: #2563eb; z-index: 3;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for enrollment in enrollments %}
                        <tr class="table-row-hover" style="transition: background 0.2s;">
                            <td class="py-3 px-4">{{ enrollment.enrollment_id }}</td>
                            <td class="py-3 px-4">{{ enrollment.course_id }}</td>
                            <td class="py-3 px-4">{{ enrollment.student_id }}</td>
                            <td class="py-3 px-4">{{ enrollment.enrollment_date }}</td>
                            <td class="py-3 px-4">{{ enrollment.status|yesno:"Active,Inactive" }}</td>
                            <td class="py-3 px-4">
                                <button class="btn btn-primary btn-sm rounded-2 px-3" onclick="openModal('editEnrollmentModal{{ enrollment.enrollment_id }}')">Edit</button>
                            </td>
                        </tr>
                        {% empty %}
                        <tr><td colspan="6" class="text-center py-4">No enrollments found.</td></tr>
                        {% endfor %}
                    </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="modal" id="addEnrollmentModal">
            <div class="modal-content">
                <span class="close btn btn-secondary float-end">&times;</span>
                <h2 class="mb-4 fw-bold text-primary">Add Enrollment</h2>
                <form method="post" action="{% url 'enrollments_list' %}">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="add">
                    {{ add_form.as_p }}
                    <button type="submit" class="btn btn-success px-4 py-2 rounded-3">Add Enrollment</button>
                </form>
            </div>
        </div>
        {% for enrollment, edit_form in enrollment_forms %}
        <div class="modal" id="editEnrollmentModal{{ enrollment.enrollment_id }}">
            <div class="modal-content">
                <span class="close btn btn-secondary float-end">&times;</span>
                <h2 class="mb-4 fw-bold text-primary">Edit Enrollment</h2>
                <form method="post" action="{% url 'enrollments_list' %}">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="edit_{{ enrollment.enrollment_id }}">
                    <input type="hidden" name="enrollment_id" value="{{ enrollment.enrollment_id }}">
                    {{ edit_form.as_p }}
                    <button type="submit" class="btn btn-primary px-4 py-2 rounded-3">Update</button>
                </form>
            </div>
        </div>
        {% endfor %}
        <style>
            .table {
                border-radius: 16px;
                overflow: hidden;
                box-shadow: 0 6px 32px rgba(0,0,0,0.12);
                background: #f8fafc;
                border: 1px solid #e3e6ed;
            }
            .table-responsive {
                scrollbar-width: none;
                -ms-overflow-style: none; 
            }
            .table-responsive::-webkit-scrollbar {
                display: none; 
            }
            .table-row-hover:hover {
                background: #e3e6ed !important;
            }
            thead.bg-primary th {
                background: linear-gradient(90deg, #2563eb 60%, #0d6efd 100%);
                color: #fff;
                border-bottom: 2px solid #2563eb;
            }
            td {
                background: #fff;
                border-bottom: 1px solid #e3e6ed;
            }
        </style>
        </div>
</body>
</html>
